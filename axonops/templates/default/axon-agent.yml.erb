# AxonOps Agent Configuration
# Generated by Chef - Local modifications will be overwritten

<% if @deployment_mode == 'saas' -%>
# SaaS Mode Configuration - Connect to AxonOps Cloud
<% if @api_key && @organization -%>
api_key: "<%= @api_key %>"
organisation: "<%= @organization %>"
<% else -%>
# WARNING: API key and organization not configured!
# Set node['axonops']['api']['key'] and node['axonops']['api']['organization']
<% end -%>
<% end -%>

axon-agent:
  # Connection to AxonOps server/cloud
  host: "<%= @hosts %>"
  port: <%= @port %>
  
<% if @deployment_mode == 'saas' -%>
  # SSL is required for SaaS mode
  ssl: true
<% else -%>
  # Self-hosted mode
  ssl: false
<% end -%>
  
<% if @disable_command_exec -%>
  # Remote command execution disabled for security
  disable_command_exec: true
<% end -%>

cassandra:
  # Cassandra installation paths
  home: "<%= @cassandra_home %>"
  config: "<%= @cassandra_config %>"
  logs: "/var/log/cassandra"
  
  # Node information
  node:
    address: "<%= node['ipaddress'] || '127.0.0.1' %>"
    dc: "<%= node['cassandra']['datacenter'] || 'dc1' %>"
    rack: "<%= node['cassandra']['rack'] || 'rack1' %>"
  
  # JMX connection
  jmx:
    host: "127.0.0.1"
    port: 7199
    # username: ""
    # password: ""
  
  # CQL connection
  cql:
    hosts: ["127.0.0.1"]
    port: 9042
    # username: ""
    # password: ""

# Monitoring configuration
metrics:
  # How often to collect metrics
  interval: 30s
  
  # Enable/disable specific metric types
  enabled:
    jmx: true
    os: true
    cassandra: true
  
logs:
  # How often to ship logs
  interval: 60s
  
  # Maximum lines per batch
  max_lines: 1000
  
  # Log files to monitor
  files:
    - path: "/var/log/cassandra/system.log"
      type: "cassandra_system"
    - path: "/var/log/cassandra/gc.log"
      type: "cassandra_gc"

# Agent logging
logging:
  level: "INFO"
  file: "/var/log/axonops/agent.log"
  
# Advanced settings
advanced:
  # Agent data directory
  data_dir: "/var/lib/axonops/agent"
  
  # Temporary directory
  temp_dir: "/tmp/axonops"
  
  # HTTP endpoint for health checks
  http:
    enabled: true
    port: 9090
    bind: "127.0.0.1"