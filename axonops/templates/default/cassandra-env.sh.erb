#!/bin/bash
# Cassandra environment configuration
# Generated by Chef - Local modifications will be overwritten

# Heap size - will be overridden by jvm options file
export MAX_HEAP_SIZE="<%= @heap_size %>"
export HEAP_NEWSIZE="<%= @new_heap_size %>"

# Log directory
export CASSANDRA_LOG_DIR="<%= @log_dir %>"

# GC log settings
JVM_OPTS="$JVM_OPTS -Xloggc:${CASSANDRA_LOG_DIR}/gc.log"

# Additional JVM options can be added here
# JVM_OPTS="$JVM_OPTS -Dcassandra.config=file://${CASSANDRA_CONF}/cassandra.yaml"

# NUMA settings
if [ "`uname`" = "Linux" ] ; then
    if [ -x /usr/bin/numactl ] ; then
        NUMACTL="/usr/bin/numactl --interleave=all"
    else
        NUMACTL=""
    fi
fi

# Export for Cassandra to use
export JVM_OPTS
export NUMACTL